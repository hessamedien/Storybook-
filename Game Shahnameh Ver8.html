<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اسطوره‌های شاهنامه</title>
    <style>
        /* سبک کلی و فونت‌ها */
        @font-face {
            font-family: 'IranNastaliq';
            src: url('https://fonts.googleapis.com/earlyaccess/iraniannastaliq.css');
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'IranNastaliq', 'B Nazanin', 'Times New Roman', serif;
            background: linear-gradient(to bottom, #1a0a0a, #2c1f1f);
            color: #e0d0b0;
            line-height: 1.8;
            padding: 20px;
            min-height: 100vh;
            background-attachment: fixed;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill="%231a0a0a" width="100" height="100"/><path fill="%232c1f1f" d="M0,0 L100,100" stroke="%233a2b2b" stroke-width="2"/></svg>');
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: rgba(20, 10, 5, 0.85);
            border: 2px solid #b8860b;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(184, 134, 11, 0.4);
            padding: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><path fill="%23b8860b" fill-opacity="0.05" d="M100,0 C155.228,0 200,44.772 200,100 C200,155.228 155.228,200 100,200 C44.772,200 0,155.228 0,100 C0,44.772 44.772,0 100,0 Z M100,20 C56,20 20,56 20,100 C20,144 56,180 100,180 C144,180 180,144 180,100 C180,56 144,20 100,20 Z"/></svg>');
            background-repeat: repeat;
            pointer-events: none;
        }
        
        h1, h2, h3 {
            color: #f8d568;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-top: 10px;
            border-bottom: 2px solid #b8860b;
            padding-bottom: 10px;
        }
        
        h2 {
            font-size: 1.8rem;
            margin-top: 20px;
        }
        
        p {
            margin-bottom: 20px;
            text-align: justify;
            font-size: 1.3rem;
        }
        
        /* صفحه شروع */
        #start-screen {
            text-align: center;
            padding: 30px;
        }
        
        .logo {
            font-size: 3.5rem;
            margin: 20px 0;
            color: #f8d568;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
        }
        
        .start-btn {
            background: linear-gradient(to bottom, #b8860b, #8b6508);
            color: #fff;
            border: none;
            padding: 15px 40px;
            font-size: 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            margin: 30px 0;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
            font-family: inherit;
        }
        
        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.5);
        }
        
        .game-info {
            margin-top: 30px;
            font-size: 1.1rem;
            color: #c0b090;
        }
        
        /* صفحه ورود اطلاعات */
        #setup-screen {
            padding: 20px;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #f8d568;
            font-size: 1.3rem;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            background-color: rgba(50, 40, 30, 0.8);
            border: 1px solid #b8860b;
            border-radius: 5px;
            color: #e0d0b0;
            font-size: 1.2rem;
            font-family: inherit;
        }
        
        /* صفحه بازی */
        #game-screen {
            padding: 20px;
        }
        
        .story-text {
            background-color: rgba(30, 20, 10, 0.7);
            border: 1px solid #b8860b;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            min-height: 250px;
            overflow-y: auto;
            font-size: 1.3rem;
            line-height: 2;
        }
        
        .choices {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .choice-btn {
            background: linear-gradient(to bottom, #3a2b2b, #2c1f1f);
            color: #e0d0b0;
            border: 1px solid #b8860b;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
            font-family: inherit;
            text-align: right;
        }
        
        .choice-btn:hover {
            background: linear-gradient(to bottom, #4a3b3b, #3c2f2f);
            transform: translateX(-5px);
        }
        
        /* صفحه پایان */
        #end-screen {
            padding: 20px;
        }
        
        .final-story {
            background-color: rgba(30, 20, 10, 0.7);
            border: 1px solid #b8860b;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            min-height: 300px;
            overflow-y: auto;
            white-space: pre-line;
            line-height: 2;
            font-size: 1.3rem;
        }
        
        .social-share {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .social-btn {
            padding: 10px 20px;
            background: linear-gradient(to bottom, #3a2b2b, #2c1f1f);
            color: #e0d0b0;
            border: 1px solid #b8860b;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
        }
        
        /* نوار پیشرفت */
        .progress-bar {
            height: 10px;
            background-color: #2c1f1f;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, #b8860b, #f8d568);
            width: 0%;
            transition: width 0.5s;
        }
        
        /* افکت‌های ویژه */
        .mythical-character {
            text-align: center;
            margin: 20px 0;
            font-weight: bold;
            color: #f8d568;
            font-size: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        }
        
        .quote {
            font-style: italic;
            border-right: 3px solid #b8860b;
            padding-right: 15px;
            margin: 15px 0;
            color: #c0b090;
        }
        
        /* صفحه‌آرایی برای موبایل */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            p {
                font-size: 1.1rem;
            }
            
            .logo {
                font-size: 2.5rem;
            }
            
            .start-btn {
                padding: 12px 30px;
                font-size: 1.2rem;
            }
            
            .story-text, .final-story {
                font-size: 1.1rem;
                min-height: 200px;
            }
            
            .choice-btn {
                font-size: 1.1rem;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- صفحه شروع -->
        <div id="start-screen">
            <div class="logo">اسطوره‌های شاهنامه</div>
            <h2>یک ماجراجویی اپیک بر اساس شاهنامه فردوسی</h2>
            <p>در این بازی، شما به دنیای اسطوره‌های ایرانی قدم می‌گذارید و با انتخاب‌های خود سرنوشت خویش و ایران‌زمین را شکل خواهید داد.</p>
            <button class="start-btn" onclick="showSetupScreen()">شروع ماجراجویی</button>
            <div class="game-info">
                <p>سازنده: حسام‌الدین</p>
                <p>ورژن: ۱.۰.۰ (مهر ۱۴۰۳)</p>
                <p>Instagram: <a href="https://instagram.com/hessamedien" style="color: #f8d568;">hessamedien</a></p>
            </div>
        </div>
        
        <!-- صفحه تنظیمات کاربر -->
        <div id="setup-screen" style="display: none;">
            <h2>پیش از آغاز سفر</h2>
            <div class="input-group">
                <label for="player-name">نام شما:</label>
                <input type="text" id="player-name" placeholder="نام خود را وارد کنید">
            </div>
            <div class="input-group">
                <label for="player-gender">جنسیت شما:</label>
                <select id="player-gender">
                    <option value="male">مرد</option>
                    <option value="female">زن</option>
                </select>
            </div>
            <button class="start-btn" onclick="startGame()">آغاز سفر</button>
        </div>
        
        <!-- صفحه بازی -->
        <div id="game-screen" style="display: none;">
            <h2>اسطوره‌های شاهنامه</h2>
            <div class="progress-bar">
                <div class="progress" id="story-progress"></div>
            </div>
            <div class="story-text" id="story-text">
                <!-- محتوای داستان اینجا نمایش داده می‌شود -->
            </div>
            <div class="choices" id="choices">
                <!-- گزینه‌های انتخابی اینجا نمایش داده می‌شوند -->
            </div>
        </div>
        
        <!-- صفحه پایان -->
        <div id="end-screen" style="display: none;">
            <h2>پایان سفر</h2>
            <div class="final-story" id="final-story">
                <!-- داستان نهایی اینجا نمایش داده می‌شود -->
            </div>
            <div class="social-share">
                <button class="social-btn" onclick="printStory()">چاپ داستان</button>
                <button class="social-btn" onclick="shareStory()">اشتراک‌گذاری</button>
                <button class="social-btn" onclick="restartGame()">شروع مجدد</button>
            </div>
            <p style="text-align: center; margin-top: 20px;">سازنده: حسام‌الدین</p>
        </div>
    </div>

    <script>
        // متغیرهای全局 بازی
        let playerName = "";
        let playerGender = "";
        let currentChapter = 0;
        let storyPath = [];
        let storyProgress = 0;
        
        // ساختار داستان و فصل‌ها
        const chapters = [
            {
                text: `در آغاز سفر، ای ${playerName} دلیر، در سرزمین اسطوره‌های ایران، زیر سایه کوه البرز ایستاده‌ای. باد شمال زمزمه می‌کند که روزهای بزرگ و انتخاب‌های سرنوشت‌ساز در پیش است.
                
                در دور دست، دو راه پیش روی توست: راه شرق به سوی شهر باستانی بلخ، جایی که گفته می‌شود رازهای کهن در آن نهفته است. راه غرب به سوی دریای مازندران، که اژدهای ضحاک روزگاری در آن حاکم بود.
                
                کدام راه را برمی‌گزینی؟`,
                choices: [
                    { text: "راه شرق به سوی بلخ", next: 1, effect: "شجاعت" },
                    { text: "راه غرب به سوی مازندران", next: 2, effect: "کنجکاوی" }
                ]
            },
            {
                text: `شهر بلخ با دیوارهای سفید و برج‌های بلندش در برابرت ظاهر می‌شود. مردم شهر با نگرانی از موجودی افسانه‌ای سخن می‌گویند که شب‌ها به گله‌هایشان حمله می‌کند.
                
                پیرمردی خردمند به پیشواز تو می‌آید و می‌گوید: "ای ${playerName}، تنها کسی که می‌تواند به ما کمک کند، پهلوانی است که از نسل جمشید باشد."
                
                تو باید تصمیم بگیری: آیا به دنبال این پهلوان اسطوره‌ای بگردی یا خودت مسئولیت نابودی موجود افسانه‌ای را به عهده بگیری؟`,
                choices: [
                    { text: "به دنبال پهلوان افسانه‌ای بگرد", next: 3, effect: "عقل گرایی" },
                    { text: "خودت مسئولیت را بپذیر", next: 4, effect: "شجاعت" }
                ]
            },
            {
                text: `ساحل دریای مازندران موج‌های خروشانی دارد. ماهیگیران محلی از تو می‌خواهند که در سفر به جزیره‌ای اسرارآموز帮助他们، جایی که گفته می‌شود گنجینه‌ای از دوران فریدون در آن نهفته است.
                
                ناگهان طوفانی سهمگین آغاز می‌شود و کشتی‌ها را تهدید می‌کند. ماهیگیران می‌گویند این خشم دیوهای دریایی است.
                
                آیا می‌خواهی با طوفان مقابله کنی یا به غارهای ساحلی پناه ببری و منتظر پایان طوفان بمانی؟`,
                choices: [
                    { text: "مقابله با طوفان", next: 5, effect: "نترسی" },
                    { text: "پناه بردن به غار", next: 6, effect: "احتیاط" }
                ]
            },
            // فصل‌های بیشتر در ادامه...
        ];
        
        // پایان‌های مختلف بازی
        const endings = {
            hero: {
                title: "پایان قهرمان",
                text: `ای ${playerName}، تو به یکی از بزرگ‌ترین قهرمانان شاهنامه تبدیل شدی. دلاوری‌ها و انتخاب‌های تو برای همیشه در تاریخ ایران ثبت خواهد شد. از گذشتن از خود برای دیگران تا مبارزه با نیروهای اهریمنی، همه و همه نشان از بزرگی روح تو دارد.\n\nآیندگان از تو به نیکی یاد خواهند کرد و نام تو در کنار نام پهلوانانی مانند رستم و سهراب خواهد درخشید.`
            },
            wise: {
                title: "پایان خردمند",
                text: `ای ${playerName}، تو با خرد و فرزانگی خود توانستی از پس چالش‌های سخت برآیی. نه با زور بازو که با نیروی عقل و تدبیر، تو به یکی از بزرگ‌ترین مشاوران پادشاهی تبدیل شدی.\n\nراهنمایی‌های تو باعث شد تا ایران از جنگ‌های بی‌حاصل دوری کند و عصر طلایی صلح و پیشرفت را تجربه نماید. دانش تو برای نسل‌های آینده به یادگار خواهد ماند.`
            },
            traveler: {
                title: "پایان جهانگرد",
                text: `ای ${playerName}، کنجکاوی و عشق تو به کشف ناشناخته‌ها، تو را به بزرگ‌ترین جهانگرد تاریخ ایران تبدیل کرد. از چین تا روم، از هند تا مصر، تو به سرزمین‌های دور سفر کردی و دانش و فرهنگ‌های مختلف را به ایران آوردی.\n\nسفرنامه‌های تو برای قرن‌ها راهنمای مسافران و traders خواهد بود و باعث گسترش فرهنگ ایرانی در سراسر جهان شده‌است.`
            }
        };
        
        // توابع مدیریت بازی
        
        function showSetupScreen() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('setup-screen').style.display = 'block';
        }
        
        function startGame() {
            playerName = document.getElementById('player-name').value || 'ناشناس';
            playerGender = document.getElementById('player-gender').value;
            
            if (!playerName) {
                alert('لطفاً نام خود را وارد کنید');
                return;
            }
            
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'block';
            
            // به روزرسانی متن فصل اول با نام بازیکن
            chapters[0].text = chapters[0].text.replace(/\${playerName}/g, playerName);
            
            loadChapter(0);
        }
        
        function loadChapter(chapterId) {
            currentChapter = chapterId;
            const chapter = chapters[chapterId];
            
            // نمایش متن داستان
            document.getElementById('story-text').innerHTML = formatStoryText(chapter.text);
            
            // ایجاد گزینه‌ها
            const choicesContainer = document.getElementById('choices');
            choicesContainer.innerHTML = '';
            
            chapter.choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.onclick = () => makeChoice(choice.next, choice.effect);
                choicesContainer.appendChild(button);
            });
            
            // به روزرسانی نوار پیشرفت
            updateProgressBar();
        }
        
        function makeChoice(nextChapter, effect) {
            // ذخیره انتخاب بازیکن
            storyPath.push({
                chapter: currentChapter,
                effect: effect,
                text: chapters[currentChapter].text.substring(0, 100) + '...'
            });
            
            // اگر به پایان بازی رسیده‌ایم
            if (nextChapter >= chapters.length) {
                endGame();
                return;
            }
            
            loadChapter(nextChapter);
        }
        
        function formatStoryText(text) {
            // جایگزینی نام بازیکن در متن
            let formattedText = text.replace(/\${playerName}/g, playerName);
            
            // اضافه کردن افکت‌های ویژه به متن
            if (formattedText.includes("ضحاک")) {
                formattedText += '<div class="mythical-character">ضحاک ماردوش</div>';
            }
            
            if (formattedText.includes("رستم")) {
                formattedText += '<div class="mythical-character">رستم دستان</div>';
            }
            
            if (formattedText.includes("فریدون")) {
                formattedText += '<div class="mythical-character">فریدون پسر آبتین</div>';
            }
            
            return formattedText;
        }
        
        function updateProgressBar() {
            const progress = (currentChapter / chapters.length) * 100;
            document.getElementById('story-progress').style.width = `${progress}%`;
            storyProgress = progress;
        }
        
        function endGame() {
            // محاسبه پایان بر اساس انتخاب‌های بازیکن
            let courage = 0;
            let wisdom = 0;
            let curiosity = 0;
            
            storyPath.forEach(choice => {
                if (choice.effect === "شجاعت" || choice.effect === "نترسی") courage++;
                if (choice.effect === "عقل گرایی" || choice.effect === "احتیاط") wisdom++;
                if (choice.effect === "کنجکاوی") curiosity++;
            });
            
            let ending;
            if (courage > wisdom && courage > curiosity) {
                ending = endings.hero;
            } else if (wisdom > courage && wisdom > curiosity) {
                ending = endings.wise;
            } else {
                ending = endings.traveler;
            }
            
            // نمایش صفحه پایان
            document.getElementById('game-screen').style.display = 'none';
            document.getElementById('end-screen').style.display = 'block';
            
            // ایجاد داستان نهایی
            let finalStory = `${ending.title}\n\n`;
            finalStory += `${ending.text}\n\n`;
            finalStory += `سفر تو به پایان رسید، ای ${playerName}.\n\n`;
            finalStory += "مسیر طی شده:\n";
            
            storyPath.forEach((step, index) => {
                finalStory += `فصل ${index + 1}: ${step.text}\n`;
            });
            
            document.getElementById('final-story').textContent = finalStory;
        }
        
        function printStory() {
            const finalStory = document.getElementById('final-story').textContent;
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html dir="rtl">
                <head>
                    <title>داستان من از اسطوره‌های شاهنامه</title>
                    <style>
                        body { 
                            font-family: 'B Nazanin', 'Times New Roman', serif; 
                            line-height: 2;
                            padding: 40px;
                            background-color: #f9f5e9;
                            color: #333;
                        }
                        h1 { color: #8b6508; text-align: center; }
                        .footer { text-align: center; margin-top: 40px; color: #777; }
                    </style>
                </head>
                <body>
                    <h1>اسطوره‌های شاهنامه</h1>
                    <pre>${finalStory}</pre>
                    <div class="footer">ساخته شده توسط حسام‌الدین | Instagram: hessamedien</div>
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }
        
        function shareStory() {
            const finalStory = document.getElementById('final-story').textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'داستان من از اسطوره‌های شاهنامه',
                    text: finalStory.substring(0, 100) + '...',
                    url: window.location.href
                })
                .catch(error => {
                    alert('متأسفانه امکان اشتراک‌گذاری مستقیم وجود ندارد. می‌توانید داستان را کپی کنید.');
                });
            } else {
                alert('مرورگر شما از قابلیت اشتراک‌گذاری مستقیم پشتیبانی نمی‌کند. می‌توانید داستان را کپی کنید.');
            }
        }
        
        function restartGame() {
            playerName = "";
            playerGender = "";
            currentChapter = 0;
            storyPath = [];
            storyProgress = 0;
            
            document.getElementById('end-screen').style.display = 'none';
            document.getElementById('start-screen').style.display = 'block';
        }
        
        // بارگذاری فایل‌های صوتی و تصویری اضافی در صورت اتصال به اینترنت
        window.addEventListener('load', function() {
            if (navigator.onLine) {
                // در اینجا می‌توان فایل‌های اضافی را بارگذاری کرد
                console.log('اتصال به اینترنت موجود است - بارگذاری منابع اضافی');
            }
        });
    </script>
</body>
</html>